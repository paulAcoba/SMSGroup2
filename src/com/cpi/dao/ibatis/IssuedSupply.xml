<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sqlmap-2.dtd">
<sqlMap namespace="IssuedSupply">
	<typeAlias alias="IssuedSupplyClass" type="com.cpi.entity.IssuedSupply" /><!-- this will initiates the xml from the entity -->
	<typeAlias alias="SupplyClass" type="com.cpi.entity.SuppliesMaintenance" />
	
	<resultMap id="allIssuedSupplyMap" class="IssuedSupplyClass">
		<result column="issue_id" property="issueId" />
		<result column="supply_id" property="supplyId" />
		<result column="issue_date" property="issueDate" />
		<result column="requestor" property="requestor" />
		<result column="quantity" property="quantity" />
		<result column="dept_id" property="deptId" />
		<result column="last_user" property="lastUser" />
		<result column="last_update" property="lastUpdate" />
	</resultMap>
	
	<resultMap id="allItemsMap" class="SupplyClass">
		<result column="supply_id" property="supplyId" />
		<result column="item_name" property="itemName" />
		<result column="actual_count" property="actualCount" />
	</resultMap>
	
	<select id="getAllIssuedSupplies" resultMap="allIssuedSupplyMap">
		SELECT * FROM issued_supplies_2
		<!-- AND s.obsolete_tag = 'Y' -->
	</select>
	
	<select id="getAllItems" resultMap="allItemsMap">
		SELECT supply_id, item_name, actual_count FROM supplies_2
	</select>
	
	<procedure id="addIssuedSupplies" parameterClass="java.util.Map">
		BEGIN
			 prod_insertIssuedSupplies (#supplyId#,#issueDate#,#requestor#,#quantity#,#deptId#,#lastUser#);
		END;
	</procedure>
	
	<select id="updateIssuedSupplies" resultClass="java.lang.String">
		BEGIN
			UPDATE issued_supplies_2
			SET issue_date = #issueDate#,
				requestor = #quantity#,
				dept_id = #deptId#,
				last_user = #lastUser#,
				last_update = #lastUpdate#
			WHERE issue_id = #issueId#
		END;
	</select>
</sqlMap>